{"version":3,"sources":["webpack:///./src/views/back/AddSong.vue","webpack:///./src/components/back/UploadSong.vue","webpack:///./src/components/back/UploadSong.vue?5186","webpack:///./src/components/back/UploadImg.vue","webpack:///./src/components/back/UploadImg.vue?b384","webpack:///./src/views/back/AddSong.vue?ed61","webpack:///./src/includes/adminReq.js"],"names":["class","type","value","ref","addSong","$event","validation-schema","songSchema","name","placeholder","as","genres","genre","key","id","isClean","uploadSong","uploadImg","isDragover","upload","choose","file","cancelFile","accept","emits","props","setup","emit","fileDom","click","e","dataTransfer","files","target","size","vlue","__exports__","preview","src","alt","cancelImg","chooseImg","imgDom","indexOf","reader","FileReader","readAsDataURL","addEventListener","event","result","genreData","getGenres","then","res","data","catch","error","console","log","songData","imgData","cleanData","FormData","append","songname","composer","music_type_id","headers","err","response","errors","components","UploadSong","UploadImg","render","refreshToken","axios","method","url","refresh_token","storage","get","instance","create","baseURL","timeout","interceptors","request","use","config","Authorization","isRefreshing","requests","Promise","reject","status","resolve","push","token","set","access_token","forEach","item","alert","remove","finally","params","post","del","delete"],"mappings":"sJACWA,MAAM,Y,GAGNA,MAAM,mC,GACJA,MAAM,S,GACJA,MAAM,+B,EACT,eAAiE,KAA9DA,MAAM,qDAAmD,S,GAKzDA,MAAM,+B,EACT,eAA2D,KAAxDA,MAAM,+CAA6C,S,GAKnDA,MAAM,2B,EACT,eAA+D,KAA5DA,MAAM,mDAAiD,S,eAUzDA,MAAM,S,EAIb,eAGS,UAHDC,KAAK,SAASD,MAAM,oGACoC,UAEhE,G,GACOC,KAAK,QAAQC,MAAM,OAAOC,IAAI,YACnCH,MAAM,2B,2MArCZ,eAuCU,UAvCV,EAuCU,CAtCR,eAqCU,GArCA,SAAM,+BAAE,EAAAI,QAAQC,KAAUC,oBAAmB,EAAAC,WACvDP,MAAM,0C,yBACJ,iBA4BM,CA5BN,eA4BM,MA5BN,EA4BM,CA3BJ,eAuBM,MAvBN,EAuBM,CAtBJ,eAKM,MALN,EAKM,CAJJ,EACA,eACyD,GAD/CC,KAAK,OAAOO,KAAK,WAAWC,YAAY,OAChDT,MAAM,iDACN,eAA+D,GAAjDA,MAAM,yBAAyBQ,KAAK,eAEtD,eAKM,MALN,EAKM,CAJJ,EACA,eACyD,GAD/CP,KAAK,OAAOO,KAAK,WAAWC,YAAY,OAChDT,MAAM,iDACN,eAA+D,GAAjDA,MAAM,yBAAyBQ,KAAK,eAEtD,eAQM,MARN,EAQM,CAPJ,EACA,eAIW,GAJDE,GAAG,SAASF,KAAK,gBAAgBN,MAAM,IAC/CF,MAAM,yD,yBACE,iBAAuB,E,mBAA/B,eAC6C,2BADrB,EAAAW,QAAM,SAAfC,G,wBAAf,eAC6C,UADZC,IAAKD,EAAME,GACzCZ,MAAOU,EAAME,I,eAAOF,EAAMJ,MAAI,Q,gBAEnC,eAAkD,GAApCR,MAAM,eAAeQ,KAAK,YAE1C,eAA0D,GAA7CO,QAAS,EAAAA,QAAU,aAAY,EAAAC,Y,qCAE9C,eAEM,MAFN,EAEM,CADJ,eAAuD,GAA3CD,QAAS,EAAAA,QAAU,YAAW,EAAAE,W,sCAG9C,EAIA,eACkC,QADlC,EACkC,c,2ECrCjCjB,MAAM,kE,EACT,eAGM,OAHDA,MAAM,0CAAwC,CACjD,eAAoC,QAA9BA,MAAM,cAAa,QACzB,eAAiE,KAA9DA,MAAM,wD,MAENA,MAAM,O,EAWP,eAA6B,UAAzB,wBAAoB,G,GAAxB,G,EAEF,eAAwD,KAArDA,MAAM,kCAAiC,cAAU,G,GAC/CA,MAAM,kC,mBAONA,MAAM,a,gDA1Bf,eAgCM,MAhCN,EAgCM,CA/BJ,EAIA,eA0BM,MA1BN,EA0BM,CAzBJ,eAWM,OAXDA,MAAK,gBAAC,sNAGwC,8CACS,EAAAkB,cACvD,UAAO,+CAAe,EAAAA,YAAU,yBAChC,WAAQ,+CAAe,EAAAA,YAAU,yBACjC,YAAS,+CAAe,EAAAA,YAAU,yBAClC,YAAS,+CAAe,EAAAA,YAAU,yBAClC,OAAI,+CAAe,EAAAC,OAAOd,KAAM,sB,MAGrC,EACA,eAQM,MARN,EAQM,CAPJ,eAE+B,UAFvBJ,KAAK,SAASD,MAAM,kFAEzB,QAAK,8BAAE,EAAAoB,QAAA,EAAAA,OAAA,sBAAQ,QACT,EAAAC,M,iBAAT,eAEI,O,8BAFc,EAAAA,KAAKb,MAAO,IAC5B,kBAAyE,KAAtER,MAAM,0CAA2C,QAAK,8BAAE,EAAAsB,YAAA,EAAAA,WAAA,2B,iBAE7D,eAAsC,IAAtC,EAA4B,aAE9B,eAE2C,SAFpCtB,MAAM,0BACXC,KAAK,OAAOO,KAAK,OAAOe,OAAO,aAC9B,SAAM,+BAAE,EAAAJ,OAAOd,KAASF,IAAI,W,8BAStB,GACbK,KAAM,aACNgB,MAAO,CAAC,cACRC,MAAO,CAAC,WACRC,MAJa,SAIPD,EAJO,GAIU,IAARE,EAAQ,EAARA,KACPZ,EAAU,eAAMU,EAAO,WACvBG,EAAU,eAAI,MACdV,EAAa,gBAAI,GACjBG,EAAO,eAAI,IACXD,EAAS,WACbQ,EAAQ1B,MAAM2B,SAEVP,EAAa,WACjBM,EAAQ1B,MAAMA,MAAQ,GACtBmB,EAAKnB,MAAQ,GACbyB,EAAK,aAAcN,EAAKnB,QAEpBiB,EAAS,SAACW,GAGd,OAFAZ,EAAWhB,OAAQ,EACnBmB,EAAKnB,MAAQ4B,EAAEC,aAAeD,EAAEC,aAAaC,MAAM,GAAKF,EAAEG,OAAOD,MAAM,GACnEX,EAAKnB,MAAMgC,KAAO,SACpB,eAAc,WAAY,WAC1BN,EAAQ1B,MAAMiC,KAAO,QACrBd,EAAKnB,MAAQ,KAGS,eAApBmB,EAAKnB,MAAMD,MACb,eAAc,SAAU,WACxB2B,EAAQ1B,MAAMiC,KAAO,QACrBd,EAAKnB,MAAQ,UAGfyB,EAAK,aAAcN,EAAKnB,QAO1B,OAJA,eAAMa,GAAS,WACbO,OAGK,CAELD,OAAMO,UAASV,aAAYE,SAAQE,aAAYH,SAAQJ,a,qBC5E7D,MAAMqB,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS,KAErD,Q,GCNRpC,MAAM,wB,EACT,eAA6B,MAAzBA,MAAM,WAAU,QAAI,G,GACnBA,MAAM,6E,GAEJA,MAAM,iB,0DAJf,eAiBM,MAjBN,EAiBM,CAhBJ,EACA,eAQM,MARN,EAQM,CANJ,eAKM,MALN,EAKM,CAJO,EAAAqC,S,iBAAX,eAA2E,O,MAAtDC,IAAK,EAAAD,QAASE,IAAI,cAAcvC,MAAM,iB,iCAClD,EAAAqC,S,iBAAT,eAEqB,K,MAFHrC,MAAM,8EAEvB,QAAK,8BAAE,EAAAwC,WAAA,EAAAA,UAAA,wB,0BAGZ,eAEkC,UAF1BvC,KAAK,SAASD,MAAM,kFAEzB,QAAK,8BAAE,EAAAyC,WAAA,EAAAA,UAAA,sBAAW,QACrB,eAE0C,SAFnCzC,MAAM,0BACXC,KAAK,OAAOO,KAAK,QAAQe,OAAO,UAC/B,SAAM,+BAAE,EAAAJ,OAAOd,KAASF,IAAI,U,YAQpB,OACbK,KAAM,YACNgB,MAAO,CAAC,aACRC,MAAO,CAAC,WACRC,MAJa,SAIPD,EAJO,GAIU,IAARE,EAAQ,EAARA,KACPZ,EAAU,eAAMU,EAAO,WACvBiB,EAAS,eAAI,MACbL,EAAU,eAAI,IACdhB,EAAO,eAAI,IAEXF,EAAS,SAACW,GACd,IAAiD,IAA7CA,EAAEG,OAAOD,MAAM,GAAG/B,KAAK0C,QAAQ,SAAnC,CAKAtB,EAAKnB,MAAQ4B,EAAEG,OAAOD,MAAM,GAC5BL,EAAK,YAAaN,GAClB,IAAMuB,EAAS,IAAIC,WACnBD,EAAOE,cAAczB,EAAKnB,OAC1B0C,EAAOG,iBAAiB,QAAQ,SAACC,GAC/BX,EAAQnC,MAAQ8C,EAAMf,OAAOgB,eAT7B,eAAc,SAAU,YAatBR,EAAY,WAChBC,EAAOxC,MAAM2B,SAGTW,EAAY,WAChBE,EAAOxC,MAAMA,MAAQ,GACrBmB,EAAKnB,MAAQ,GACbmC,EAAQnC,MAAQ,GAChByB,EAAK,YAAaN,IAOpB,OAJA,eAAMN,GAAS,WACbyB,OAGK,CACLE,SAAQL,UAASlB,SAAQsB,YAAWD,eC7D1C,MAAM,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS,KAErD,Q,YJ6CT,EAAe,WACnB,IAAMU,EAAY,eAAS,CAAEvC,OAAQ,KAC/BwC,EAAQ,yDAAI,8GACV,eAAI,uBAAuBC,MAAK,SAACC,GACrCH,EAAUvC,OAAS0C,EAAIC,KAAKA,QAC3BC,OAAM,SAACC,GACRC,QAAQC,IAAIF,MAJE,2CAAJ,qDAOd,EAAmB,eAAON,GAAlBvC,EAAR,EAAQA,OACR,MAAO,CAAEA,SAAQwC,cAIb,EAAmB,WACvB,IAAMQ,EAAW,eAAS,CAAEtC,KAAM,KAC5BL,EAAa,SAACK,GAClBsC,EAAStC,KAAOA,GAGlB,MAAO,CAAEsC,WAAU3C,eAIf,EAAkB,WACtB,IAAM4C,EAAU,eAAS,CAAEvC,KAAM,KAC3BJ,EAAY,SAACI,GACjBuC,EAAQvC,KAAOA,GAGjB,MAAO,CAAEuC,UAAS3C,cAId,EAAgB,SAAC0C,EAAUC,GAC/B,IAAMC,EAAY,eAAI,MAChB9C,EAAU,gBAAI,GACdX,EAAM,yDAAI,WAAO0B,GAAP,0FACT6B,EAAStC,KADA,uBAEZ,eAAY,UAFA,iCAKRiC,EAAO,IAAIQ,SACjBR,EAAKS,OAAO,OAAQjC,EAAEkC,UACtBV,EAAKS,OAAO,WAAYjC,EAAEmC,UAC1BX,EAAKS,OAAO,gBAAiBjC,EAAEoC,eAC/BZ,EAAKS,OAAO,OAAQJ,EAAStC,MACzBuC,EAAQvC,MACViC,EAAKS,OAAO,QAASH,EAAQvC,MAE/B,eAAY,UAbE,UAcR,eAAK,iBAAkBiC,EAAM,CACjCa,QAAS,CAAE,eAAgB,yBAC1Bf,MAAK,WACN,eAAc,WACbG,OAAM,SAACa,GACRX,QAAQC,IAAIU,EAAIC,SAASf,KAAKgB,WAnBlB,QAqBd,iBACAvD,EAAQb,OAASa,EAAQb,MACzB2D,EAAU3D,MAAM2B,QAvBF,4CAAJ,sDAyBZ,MAAO,CAAEd,UAAS8C,YAAWzD,YAGhB,GACbI,KAAM,UACN+D,WAAY,CACVC,aACAC,aAEF/C,MANa,WAOX,IAAMnB,EAAa,CACjByD,SAAU,wBACVC,SAAU,wBACVC,cAAe,YAEjB,EAAiC,IAAzBP,EAAR,EAAQA,SAAU3C,EAAlB,EAAkBA,WAClB,EAA+B,IAAvB4C,EAAR,EAAQA,QAAS3C,EAAjB,EAAiBA,UACjB,EAA8B,IAAtBN,EAAR,EAAQA,OAAQwC,EAAhB,EAAgBA,UAChB,EAAwC,EAAcQ,EAAUC,GAAxD7C,EAAR,EAAQA,QAAS8C,EAAjB,EAAiBA,UAAWzD,EAA5B,EAA4BA,QAE5B,OADA+C,IACO,CACLxC,SAAQI,UAAS8C,YAAW7C,aAAYC,YAAWb,UAASG,gBKlIlE,MAAM,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASmE,KAErD,gB,mMCJTC,EAAe,kBAAMC,IAAM,CAC/BC,OAAQ,OACRC,IAAK,wDACLxB,KAAM,CAAEyB,cAAeC,OAAQC,IAAI,oBAG/BC,EAAWN,IAAMO,OAAO,CAC5BC,QAAS,wCACTC,QAAS,MAGXH,EAASI,aAAaC,QAAQC,KAAI,SAACC,GAGjC,OADAA,EAAOtB,QAAQuB,cAAf,iBAAyCV,OAAQC,IAAI,eAC9CQ,KAET,SAACrB,GACCX,QAAQC,IAAIU,MAGd,IAAIuB,GAAe,EACfC,EAAW,GAEfV,EAASI,aAAajB,SAASmB,KAC7B,SAACnC,GAAD,OAASA,KACT,SAACe,GACC,IAAKA,EAAIC,SAAU,OAAOwB,QAAQC,OAAO1B,GACzC,IAAQqB,EAAWrB,EAAXqB,OACR,OAA4B,MAAxBrB,EAAIC,SAAS0B,OACVJ,EAqBI,IAAIE,SAAQ,SAACG,GAClBJ,EAASK,MAAK,SAACC,GACbT,EAAOtB,QAAQuB,cAAf,iBAAyCQ,GACzChB,EAASO,GAAQrC,MAAK,SAACC,GAAD,OAAS2C,EAAQ3C,aAvB3CsC,GAAe,EACfhB,IAAevB,MAAK,SAACC,GACnB2B,OAAQmB,IAAI,aAAc9C,EAAIC,KAAK8C,cACnCpB,OAAQmB,IAAI,eAAgB9C,EAAIC,KAAKyB,eACrCU,EAAOtB,QAAQuB,cAAf,iBAAyCrC,EAAIC,KAAK8C,cAElDR,EAASS,SAAQ,SAACC,GAAD,OAAUA,EAAKjD,EAAIC,KAAK8C,iBACzCR,EAAW,MACVrC,OAAM,WACPgD,MAAM,iBACNvB,OAAQwB,OAAO,cACfxB,OAAQwB,OAAO,mBACdC,SAAQ,WACTd,GAAe,KAEV,IAAIE,SAAQ,SAACG,GAClBd,EAASO,GAAQrC,MAAK,SAACiB,GAAD,OAAc2B,EAAQ3B,UAY3CwB,QAAQC,OAAO1B,MAInB,IAAMa,EAAM,SAACH,GAAD,IAAM4B,EAAN,uDAAe,GAAf,OAAsBxB,EAASD,IAAIH,EAAK,CAAE4B,YAEhDC,EAAO,SAAC7B,GAAD,IAAMxB,EAAN,uDAAa,GAAImC,EAAjB,8CAA4BP,EAASyB,KAAK7B,EAAKxB,EAAMmC,IAE5DmB,EAAM,SAAC9B,GAAD,IAAM4B,EAAN,uDAAe,GAAf,OAAsBxB,EAAS2B,OAAO/B,EAAK,CAAE4B","file":"js/chunk-c4eceeac.111e4d11.js","sourcesContent":["<template>\n  <section class=\"relative\">\n    <VeeForm @submit=\"addSong($event)\" :validation-schema=\"songSchema\"\n    class=\"bg-green-200 bg-opacity-80 p-4 rounded\">\n      <div class=\"flex justify-between gap-3 mb-2\">\n        <div class=\"w-3/4\">\n          <div class=\"songnamegroup relative mb-3\">\n            <i class=\"fas fa-compact-disc absolute top-2 left-3 text-xl\"></i>\n            <VeeField type=\"text\" name=\"songname\" placeholder=\"歌曲名稱\"\n              class=\"h-10 pl-10 text-xl block w-full rounded mb-1\" />\n              <ErrorMessage class=\"text-red-600 font-bold\" name=\"songname\" />\n          </div>\n          <div class=\"composergroup relative mb-3\">\n            <i class=\"fas fa-marker absolute top-2 left-3 text-xl\"></i>\n            <VeeField type=\"text\" name=\"composer\" placeholder=\"作者名稱\"\n              class=\"h-10 pl-10 text-xl block w-full rounded mb-1\" />\n              <ErrorMessage class=\"text-red-600 font-bold\" name=\"composer\" />\n          </div>\n          <div class=\"typegroup relative mb-3\">\n            <i class=\"fas fa-headphones absolute top-2 left-3 text-xl\"></i>\n            <VeeField as=\"select\" name=\"music_type_id\" value=\"1\"\n              class=\"password h-10 px-10 text-xl block w-full rounded mb-1\">\n              <option v-for=\"genre in genres\" :key=\"genre.id\"\n                :value=\"genre.id\">{{ genre.name }}</option>\n            </VeeField>\n            <ErrorMessage class=\"text-red-600\" name=\"genre\" />\n          </div>\n          <UploadSong :isClean=\"isClean\" @uploadSong=\"uploadSong\" />\n        </div>\n        <div class=\"w-1/4\">\n          <UploadImg :isClean=\"isClean\" @uploadImg=\"uploadImg\" />\n        </div>\n      </div>\n      <button type=\"submit\" class=\"block w-full font-bold bg-green-600\n        text-white py-1.5 px-3 rounded transition hover:bg-green-700\">\n        新增歌曲\n      </button>\n      <input type=\"reset\" value=\"清除資料\" ref=\"cleanData\"\n        class=\"fixed -top-10 opacity-0\">\n    </VeeForm>\n  </section>\n</template>\n\n<script>\nimport { ref, reactive, toRefs } from 'vue';\nimport { get, post } from '@/includes/adminReq';\nimport UploadSong from '@/components/back/UploadSong.vue';\nimport UploadImg from '@/components/back/UploadImg.vue';\nimport { successNotify, errorNotify } from '@/composables/useNotification';\nimport { showLoading, hideLoading } from '@/composables/useLoading';\n\n// 取得曲風\nconst handleGenres = () => {\n  const genreData = reactive({ genres: [] });\n  const getGenres = async () => {\n    await get('v1/admin/music-type').then((res) => {\n      genreData.genres = res.data.data;\n    }).catch((error) => {\n      console.log(error);\n    });\n  };\n  const { genres } = toRefs(genreData);\n  return { genres, getGenres };\n};\n\n// 取得音樂檔\nconst handleUploadSong = () => {\n  const songData = reactive({ file: [] });\n  const uploadSong = (file) => {\n    songData.file = file;\n  };\n\n  return { songData, uploadSong };\n};\n\n// 取得圖片檔\nconst handleUploadImg = () => {\n  const imgData = reactive({ file: [] });\n  const uploadImg = (file) => {\n    imgData.file = file;\n  };\n\n  return { imgData, uploadImg };\n};\n\n// 新增歌曲\nconst handleAddSong = (songData, imgData) => {\n  const cleanData = ref(null);\n  const isClean = ref(false);\n  const addSong = async (e) => {\n    if (!songData.file) {\n      errorNotify('尚未上傳歌曲');\n      return;\n    }\n    const data = new FormData();\n    data.append('name', e.songname);\n    data.append('composer', e.composer);\n    data.append('music_type_id', e.music_type_id);\n    data.append('file', songData.file);\n    if (imgData.file) {\n      data.append('image', imgData.file);\n    }\n    showLoading('新增中...');\n    await post('v1/admin/music', data, {\n      headers: { 'Content-Type': 'multipart/form-data' },\n    }).then(() => {\n      successNotify('新增成功');\n    }).catch((err) => {\n      console.log(err.response.data.errors);\n    });\n    hideLoading();\n    isClean.value = !isClean.value;\n    cleanData.value.click();\n  };\n  return { isClean, cleanData, addSong };\n};\n\nexport default {\n  name: 'AddSong',\n  components: {\n    UploadSong,\n    UploadImg,\n  },\n  setup() {\n    const songSchema = {\n      songname: 'required|min:3|max:30',\n      composer: 'required|min:3|max:30',\n      music_type_id: 'required',\n    };\n    const { songData, uploadSong } = handleUploadSong();\n    const { imgData, uploadImg } = handleUploadImg();\n    const { genres, getGenres } = handleGenres();\n    const { isClean, cleanData, addSong } = handleAddSong(songData, imgData);\n    getGenres();\n    return {\n      genres, isClean, cleanData, uploadSong, uploadImg, addSong, songSchema,\n    };\n  },\n};\n</script>\n","<template>\n  <div class=\"bg-white rounded border border-gray-200 relative flex flex-col\">\n    <div class=\"p-6 font-bold border-b border-gray-200\">\n      <span class=\"card-title\">上傳歌曲</span>\n      <i class=\"fas fa-upload float-right text-green-400 text-2xl\"></i>\n    </div>\n    <div class=\"p-6\">\n      <div class=\" w-full px-10 py-20 rounded text-center cursor-pointer\n          border border-dashed border-gray-400 text-gray-400\n          transition duration-500 hover:text-white hover:bg-green-400\n          hover:border-green-400 hover:border-solid mb-3\"\n          :class=\"{ 'bg-green-400 border-green-400 border-solid': isDragover }\"\n          @dragend.prevent.stop=\"isDragover = false\"\n          @dragover.prevent.stop=\"isDragover = true\"\n          @dragenter.prevent.stop=\"isDragover = true\"\n          @dragleave.prevent.stop=\"isDragover = false\"\n          @drop.prevent.stop=\"upload($event)\">\n        <h5>Drop your files here</h5>\n      </div>\n      <p class=\"text-red-500 text-sm font-bold\">檔案限制 : 5MB</p>\n      <div class=\"flex items-center gap-x-4 mt-3\">\n        <button type=\"button\" class=\"block bg-green-500 rounded text-white\n          hover:bg-green-400 duration-500 px-2 py-1\"\n          @click=\"choose\">選擇歌曲</button>\n        <p v-if=\"file\">{{ file.name }}\n          <i class=\"fa fa-times text-xl ml-3 cursor-pointer\" @click=\"cancelFile\" />\n        </p>\n        <p class=\"font-bold\" v-else>尚未上傳歌曲</p>\n      </div>\n      <input class=\"fixed -top-10 opacity-0\"\n        type=\"file\" name=\"file\" accept=\"audio/mpeg\"\n        @change=\"upload($event)\" ref=\"fileDom\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, toRef, watch } from 'vue';\nimport { warningNotify } from '@/composables/useNotification';\n\nexport default {\n  name: 'UploadSong',\n  emits: ['uploadSong'],\n  props: ['isClean'],\n  setup(props, { emit }) {\n    const isClean = toRef(props, 'isClean');\n    const fileDom = ref(null);\n    const isDragover = ref(false);\n    const file = ref('');\n    const choose = () => {\n      fileDom.value.click();\n    };\n    const cancelFile = () => {\n      fileDom.value.value = '';\n      file.value = '';\n      emit('uploadSong', file.value);\n    };\n    const upload = (e) => {\n      isDragover.value = false;\n      file.value = e.dataTransfer ? e.dataTransfer.files[0] : e.target.files[0];\n      if (file.value.size > 5242880) {\n        warningNotify('超過檔案大小限制', '請選擇歌曲檔案');\n        fileDom.value.vlue = '';\n        file.value = '';\n        return;\n      }\n      if (file.value.type !== 'audio/mpeg') {\n        warningNotify('檔案格式錯誤', '請選擇歌曲檔案');\n        fileDom.value.vlue = '';\n        file.value = '';\n        return;\n      }\n      emit('uploadSong', file.value);\n    };\n\n    watch(isClean, () => {\n      cancelFile();\n    });\n\n    return {\n      // eslint-disable-next-line vue/no-dupe-keys\n      file, fileDom, isDragover, choose, cancelFile, upload, isClean,\n    };\n  },\n};\n</script>\n\n<style>\n\n</style>\n","import { render } from \"./UploadSong.vue?vue&type=template&id=4c4b0a24\"\nimport script from \"./UploadSong.vue?vue&type=script&lang=js\"\nexport * from \"./UploadSong.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\xampp\\\\htdocs\\\\song\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div class=\"bg-white p-4 rounded\">\n    <h3 class=\"text-xl\">音樂圖片</h3>\n    <div class=\"w-full border aspect-w-1 aspect-h-1 mb-4\n      rounded overflow-hidden relative\">\n      <div class=\"w-full h-full\">\n        <img v-if=\"preview\" :src=\"preview\" alt=\"music photo\" class=\"w-full h-full\">\n        <i v-if=\"preview\" class=\"fa fa-times text-xl cursor-pointer px-1\n          absolute top-3 right-3 rounded-full\"\n        @click=\"cancelImg\" />\n      </div>\n    </div>\n    <button type=\"button\" class=\"block bg-green-500 rounded text-white\n      hover:bg-green-400 duration-500 px-2 py-1\"\n      @click=\"chooseImg\">選擇圖片</button>\n    <input class=\"fixed -top-10 opacity-0\"\n      type=\"file\" name=\"image\" accept=\"image/*\"\n      @change=\"upload($event)\" ref=\"imgDom\" />\n  </div>\n</template>\n\n<script>\nimport { ref, toRef, watch } from 'vue';\nimport { warningNotify } from '@/composables/useNotification';\n\nexport default {\n  name: 'UploadImg',\n  emits: ['uploadImg'],\n  props: ['isClean'],\n  setup(props, { emit }) {\n    const isClean = toRef(props, 'isClean');\n    const imgDom = ref(null);\n    const preview = ref('');\n    const file = ref('');\n\n    const upload = (e) => {\n      if (e.target.files[0].type.indexOf('image') === -1) {\n        warningNotify('檔案格式錯誤', '請選擇圖片檔案');\n        return;\n      }\n      // eslint-disable-next-line prefer-destructuring\n      file.value = e.target.files[0];\n      emit('uploadImg', file);\n      const reader = new FileReader();\n      reader.readAsDataURL(file.value);\n      reader.addEventListener('load', (event) => {\n        preview.value = event.target.result;\n      });\n    };\n\n    const chooseImg = () => {\n      imgDom.value.click();\n    };\n\n    const cancelImg = () => {\n      imgDom.value.value = '';\n      file.value = '';\n      preview.value = '';\n      emit('uploadImg', file);\n    };\n\n    watch(isClean, () => {\n      cancelImg();\n    });\n\n    return {\n      imgDom, preview, upload, chooseImg, cancelImg,\n    };\n  },\n};\n</script>\n","import { render } from \"./UploadImg.vue?vue&type=template&id=65230bc5\"\nimport script from \"./UploadImg.vue?vue&type=script&lang=js\"\nexport * from \"./UploadImg.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\xampp\\\\htdocs\\\\song\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./AddSong.vue?vue&type=template&id=cf4adbe8\"\nimport script from \"./AddSong.vue?vue&type=script&lang=js\"\nexport * from \"./AddSong.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\xampp\\\\htdocs\\\\song\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import axios from 'axios';\nimport storage from '@/includes/storage';\n\nconst refreshToken = () => axios({\n  method: 'post',\n  url: 'https://api.sally-handmade.com/music/v1/admin/refresh',\n  data: { refresh_token: storage.get('adminRefresh') },\n});\n\nconst instance = axios.create({\n  baseURL: 'https://api.sally-handmade.com/music/',\n  timeout: 10000,\n});\n\ninstance.interceptors.request.use((config) => {\n  // eslint-disable-next-line no-param-reassign\n  config.headers.Authorization = `Bearer ${storage.get('adminToken')}`;\n  return config;\n},\n(err) => {\n  console.log(err);\n});\n\nlet isRefreshing = false;\nlet requests = [];\n\ninstance.interceptors.response.use(\n  (res) => res,\n  (err) => {\n    if (!err.response) return Promise.reject(err);\n    const { config } = err;\n    if (err.response.status === 401) {\n      if (!isRefreshing) {\n        isRefreshing = true;\n        refreshToken().then((res) => {\n          storage.set('adminToken', res.data.access_token);\n          storage.set('adminRefresh', res.data.refresh_token);\n          config.headers.Authorization = `Bearer ${res.data.access_token}`;\n\n          requests.forEach((item) => item(res.data.access_token));\n          requests = [];\n        }).catch(() => {\n          alert('因長時間未上線，請重新登入');\n          storage.remove('adminToken');\n          storage.remove('adminRefresh');\n        }).finally(() => {\n          isRefreshing = false;\n        });\n        return new Promise((resolve) => {\n          instance(config).then((response) => resolve(response));\n        });\n      // eslint-disable-next-line no-else-return\n      } else {\n        return new Promise((resolve) => {\n          requests.push((token) => {\n            config.headers.Authorization = `Bearer ${token}`;\n            instance(config).then((res) => resolve(res));\n          });\n        });\n      }\n    }\n    return Promise.reject(err);\n  },\n);\n\nexport const get = (url, params = {}) => instance.get(url, { params });\n\nexport const post = (url, data = {}, config) => instance.post(url, data, config);\n\nexport const del = (url, params = {}) => instance.delete(url, { params });\n"],"sourceRoot":""}