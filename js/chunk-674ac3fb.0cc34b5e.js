(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-674ac3fb"],{"08ed":function(e,t,n){"use strict";n.r(t);var r=n("7a23"),a=function(e){return Object(r["D"])("data-v-42fbb8fa"),e=e(),Object(r["B"])(),e},c={class:"relative"},o={class:"container bg-red-400 mx-auto p-3 h-full flex flex-col"},i={class:"w-2/4"},u={class:"colorgroup relative w-20"},l=a((function(){return Object(r["i"])("i",{class:"fas fa-palette absolute top-2 left-3 text-xl"},null,-1)})),s=a((function(){return Object(r["i"])("button",{type:"submit",class:"border border-white text-white px-5 py-2 text-xl rounded"}," 新增",-1)})),d={type:"reset",value:"清除",ref:"resetBtn",class:"fixed -top-10 opacity-0"},f=Object(r["j"])('<div class="border-2 border-yellow-600 shadow-lg" data-v-42fbb8fa><div class="grid grid-cols-10 gap-4 h-14 text-white text-xl font-bold bg-yellow-600" data-v-42fbb8fa><div class="flex p-1" data-v-42fbb8fa><span class="m-auto" data-v-42fbb8fa>id</span></div><div class="flex p-1 col-span-4" data-v-42fbb8fa><span class="m-auto" data-v-42fbb8fa>曲風名稱</span></div><div class="flex p-1 col-span-2" data-v-42fbb8fa><span class="m-auto" data-v-42fbb8fa>背景顏色</span></div><div class="flex p-1" data-v-42fbb8fa><span class="m-auto" data-v-42fbb8fa>狀態</span></div><div class="flex p-1" data-v-42fbb8fa><span class="m-auto" data-v-42fbb8fa>編輯</span></div><div class="flex p-1" data-v-42fbb8fa><span class="m-auto" data-v-42fbb8fa>刪除</span></div></div></div>',1),b={class:"h-full overflow-auto"};function p(e,t,n,a,p,v){var m=Object(r["J"])("VeeField"),h=Object(r["J"])("ErrorMessage"),j=Object(r["J"])("VeeForm"),O=Object(r["J"])("GenreItem");return Object(r["A"])(),Object(r["h"])("section",c,[Object(r["i"])("div",o,[Object(r["l"])(j,{onSubmit:a.addGenre,"validation-schema":a.genreSchema,class:"flex justify-center items-center gap-4 p-2 mb-3"},{default:Object(r["W"])((function(){return[Object(r["i"])("div",i,[Object(r["l"])(m,{type:"text",name:"name",class:"rounded w-full p-2 text-2xl",placeholder:"輸入曲風名稱"}),Object(r["l"])(h,{class:"text-white font-bold",name:"name"})]),Object(r["i"])("div",u,[l,Object(r["l"])(m,{type:"color",name:"color",value:"#FF0000",class:"h-10 cursor-pointer w-full rounded pr-1 pl-10"})]),s,Object(r["i"])("input",d,null,512)]})),_:1},8,["onSubmit","validation-schema"]),f,Object(r["i"])("div",b,[(Object(r["A"])(!0),Object(r["h"])(r["a"],null,Object(r["H"])(a.genres,(function(e,t){return Object(r["A"])(),Object(r["f"])(O,{key:e.id,genre:e,i:t,onEditGenre:a.editGenre,onDeleteGenre:a.deleteGenre},null,8,["genre","i","onEditGenre","onDeleteGenre"])})),128))])])])}var v=n("1da1"),m=(n("b0c0"),n("159b"),n("a434"),n("96cf"),n("0c0f")),h=function(e){return Object(r["D"])("data-v-26e106a6"),e=e(),Object(r["B"])(),e},j={class:"flex"},O={class:"m-auto"},g={class:"col-span-4 flex"},y={class:"m-auto"},w={class:"col-span-2 flex"},x=["title"],k={class:"flex"},G={class:"flex"},S=h((function(){return Object(r["i"])("i",{class:"fa fa-pencil-alt"},null,-1)})),A=[S],E={class:"flex"},R=h((function(){return Object(r["i"])("i",{class:"fa fa-times"},null,-1)})),T=[R],D=h((function(){return Object(r["i"])("div",{class:"text-center w-1/10"},null,-1)})),F={class:"w-2/5"},V={class:"namegroup relative w-4/5 mx-auto"},P=h((function(){return Object(r["i"])("i",{class:"fas fa-file-signature absolute top-2 left-3 text-xl"},null,-1)})),U={class:"w-1/5"},_={class:"colorgroup relative w-4/5 mx-auto"},B=h((function(){return Object(r["i"])("i",{class:"fas fa-palette absolute top-2 left-3 text-xl"},null,-1)})),C={class:"text-center w-1/10"},M=h((function(){return Object(r["i"])("p",null,"狀態",-1)})),H=h((function(){return Object(r["i"])("div",{class:"text-center w-1/10"},[Object(r["i"])("button",{type:"submit",class:"px-5 py-3 text-white font-bold rounded-lg bg-green-500 hover:bg-green-600"},"編輯")],-1)})),I={class:"text-center w-1/10"};function J(e,t,n,a,c,o){var i=Object(r["J"])("VeeField"),u=Object(r["J"])("Switch"),l=Object(r["J"])("VeeForm");return Object(r["A"])(),Object(r["h"])(r["a"],null,[Object(r["i"])("div",{class:Object(r["t"])(["grid grid-cols-10 gap-4 hover:bg-blue-400 h-14",{"bg-yellow-300":a.i%2===0,"bg-yellow-400":a.i%2===1}])},[Object(r["i"])("div",j,[Object(r["i"])("span",O,Object(r["M"])(a.genre.id),1)]),Object(r["i"])("div",g,[Object(r["i"])("span",y,Object(r["M"])(a.genre.name),1)]),Object(r["i"])("div",w,[Object(r["i"])("span",{class:"m-auto w-10 h-10 rounded",title:a.genre.color,style:Object(r["u"])({"background-color":a.genre.color})},null,12,x)]),Object(r["i"])("div",k,[Object(r["i"])("span",{class:Object(r["t"])(["m-auto w-5 h-5 rounded-full",a.genre.status?"bg-green-600":"bg-red-600"])},null,2)]),Object(r["i"])("div",G,[Object(r["i"])("button",{class:"py-1 px-2 rounded text-white bg-green-600 m-auto",onClick:t[0]||(t[0]=Object(r["Z"])((function(e){return a.editForm=!a.editForm}),["prevent"]))},A)]),Object(r["i"])("div",E,[Object(r["i"])("button",{class:"py-1 px-2 rounded text-white bg-red-600 m-auto",onClick:t[1]||(t[1]=Object(r["Z"])((function(e){return a.deleteGenre(a.genre.id)}),["prevent"]))},T)])],2),Object(r["X"])(Object(r["i"])("div",null,[Object(r["l"])(l,{"initial-values":a.genre,onSubmit:t[4]||(t[4]=function(e){return a.editGenre(e,a.genre.id)}),class:"bg-green-300 flex items-center gap-4 py-2"},{default:Object(r["W"])((function(){return[D,Object(r["i"])("div",F,[Object(r["i"])("div",V,[P,Object(r["l"])(i,{type:"text",name:"name",placeholder:"曲風名稱",class:"h-10 pl-10 w-full text-xl block rounded"})])]),Object(r["i"])("div",U,[Object(r["i"])("div",_,[B,Object(r["l"])(i,{type:"color",name:"color",class:"h-10 pr-1 pl-10 w-full text-xl block rounded"})])]),Object(r["i"])("div",C,[M,Object(r["l"])(u,{modelValue:a.enabled,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.enabled=e}),class:Object(r["t"])([a.enabled?"bg-green-400":"bg-red-400","relative inline-flex items-center h-6 transition-colors rounded-full w-11"])},{default:Object(r["W"])((function(){return[Object(r["i"])("span",{class:Object(r["t"])([a.enabled?"translate-x-6":"translate-x-1","inline-block w-4 h-4 transition-transform transform bg-white rounded-full"])},null,2)]})),_:1},8,["modelValue","class"])]),H,Object(r["i"])("div",I,[Object(r["i"])("button",{type:"button",class:"px-5 py-3 text-white font-bold rounded-lg bg-red-500 hover:bg-red-600",onClick:t[3]||(t[3]=function(e){return a.editForm=!1})},"取消")])]})),_:1},8,["initial-values"])],512),[[r["S"],a.editForm]])],64)}var L=n("4476"),$=n("a85c"),K=function(e,t){var n=Object(r["G"])(!1),a=Object(r["G"])(e.value.status),c=function(r,c){var o=1;a.value||(o=0);var i=new FormData;i.append("name",r.name),i.append("color",r.color),i.append("status",o),i.append("_method","put"),t("editGenre",c,i),e.value.name=r.name,e.value.color=r.color,e.value.status=a.value,n.value=!1};return{editForm:n,enabled:a,editGenre:c}},N={name:"GenreItem",components:{Switch:L["a"]},props:["genre","i"],emits:["editGenre","deleteGenre"],setup:function(e,t){var n=t.emit,a=Object(r["N"])(e,"genre"),c=Object(r["N"])(e,"i"),o=K(a,n),i=o.editForm,u=o.enabled,l=o.editGenre,s=function(e){Object($["a"])().then((function(t){t&&n("deleteGenre",e)}))};return{genre:a,i:c,enabled:u,editForm:i,deleteGenre:s,editGenre:l}}},z=(n("5212"),n("6b0d")),W=n.n(z);const q=W()(N,[["render",J],["__scopeId","data-v-26e106a6"]]);var Y=q,Z=n("6650"),X=n("babd"),Q=function(){var e=Object(r["E"])({genres:[]}),t=function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Object(X["b"])(),t.prev=1,t.next=4,Object(m["b"])("v1/admin/music-type");case 4:n=t.sent,e.genres=n.data.data,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:Object(X["a"])();case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return{genreData:e,getGenres:t}},ee=function(e,t){var n=function(){var n=Object(v["a"])(regeneratorRuntime.mark((function n(r){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Object(X["b"])("新增中..."),n.prev=1,n.next=4,Object(m["c"])("v1/admin/music-type",r);case 4:a=n.sent,e.genres.push(a.data.data),Object(Z["b"])("新增成功"),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](1),Object(Z["a"])(n.t0.response);case 12:Object(X["a"])(),t.value.click();case 14:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}();return n},te=function(){var e=function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Object(X["b"])("新增中..."),e.next=3,Object(m["c"])("v1/admin/music-type/".concat(t),n).then((function(){Object(Z["b"])("編輯成功!")})).catch((function(e){Object(Z["a"])("Error",e.response.data.errors.name[0])}));case 3:Object(X["a"])();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return e},ne=function(e){var t=function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Object(X["b"])("刪除中..."),t.next=3,Object(m["a"])("v1/admin/music-type/".concat(n)).then((function(){e.genres.forEach((function(t,r){t.id===n&&e.genres.splice(r,1)})),Object(Z["b"])("刪除成功")})).catch((function(e){Object(Z["a"])("無法刪除",e.response.data.message)}));case 3:Object(X["a"])();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return t},re={name:"GenreList",components:{GenreItem:Y},setup:function(){var e=Object(r["G"])(null),t={name:"required"},n=Q(),a=n.genreData,c=n.getGenres,o=ee(a,e),i=te(),u=ne(a);c();var l=Object(r["O"])(a),s=l.genres;return{genres:s,resetBtn:e,genreSchema:t,addGenre:o,editGenre:i,deleteGenre:u}}};n("ef31");const ae=W()(re,[["render",p],["__scopeId","data-v-42fbb8fa"]]);t["default"]=ae},"0c0f":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return f}));n("d3b7"),n("159b");var r=n("bc3a"),a=n.n(r),c=n("b250"),o=function(){return a()({method:"post",url:"https://api.sally-handmade.com/music/v1/admin/refresh",data:{refresh_token:c["a"].get("adminRefresh")}})},i=a.a.create({baseURL:"https://api.sally-handmade.com/music/",timeout:1e4});i.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(c["a"].get("adminToken")),e}),(function(e){console.log(e)}));var u=!1,l=[];i.interceptors.response.use((function(e){return e}),(function(e){if(!e.response)return Promise.reject(e);var t=e.config;return 401===e.response.status?u?new Promise((function(e){l.push((function(n){t.headers.Authorization="Bearer ".concat(n),i(t).then((function(t){return e(t)}))}))})):(u=!0,o().then((function(e){c["a"].set("adminToken",e.data.access_token),c["a"].set("adminRefresh",e.data.refresh_token),t.headers.Authorization="Bearer ".concat(e.data.access_token),l.forEach((function(t){return t(e.data.access_token)})),l=[]})).catch((function(){alert("因長時間未上線，請重新登入"),c["a"].remove("adminToken"),c["a"].remove("adminRefresh")})).finally((function(){u=!1})),new Promise((function(e){i(t).then((function(t){return e(t)}))}))):Promise.reject(e)}));var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.get(e,{params:t})},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return i.post(e,t,n)},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.delete(e,{params:t})}},3483:function(e,t,n){},4476:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function a(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function c(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return n=e[Symbol.iterator](),n.next.bind(n)}n.d(t,"a",(function(){return S}));var u,l,s,d=n("7a23");function f(e,t){if(e in t){for(var n=t[e],r=arguments.length,a=new Array(r>2?r-2:0),c=2;c<r;c++)a[c-2]=arguments[c];return"function"===typeof n?n.apply(void 0,a):n}var o=new Error('Tried to handle "'+e+'" but there is no handler defined. Only defined handlers are: '+Object.keys(t).map((function(e){return'"'+e+'"'})).join(", ")+".");throw Error.captureStackTrace&&Error.captureStackTrace(o,f),o}function b(e){var t=e.visible,n=void 0===t||t,c=e.features,o=void 0===c?u.None:c,i=a(e,["visible","features"]);if(n)return p(i);if(o&u.Static&&i.props["static"])return p(i);if(o&u.RenderStrategy){var s,d,b=null==(s=i.props.unmount)||s?l.Unmount:l.Hidden;return f(b,(d={},d[l.Unmount]=function(){return null},d[l.Hidden]=function(){return p(r({},i,{props:r({},i.props,{hidden:!0,style:{display:"none"}})}))},d))}return p(i)}function p(e){var t=e.props,n=e.attrs,r=e.slots,c=e.slot,o=e.name,i=v(t,["unmount","static"]),u=i.as,l=a(i,["as"]),s=null==r["default"]?void 0:r["default"](c);if("template"===u){if(Object.keys(l).length>0||Object.keys(n).length>0){var f=null!=s?s:[],b=f[0],p=f.slice(1);if(!m(b)||p.length>0)throw new Error(['Passing props on "template"!',"","The current component <"+o+' /> is rendering a "template".',"However we need to passthrough the following props:",Object.keys(l).concat(Object.keys(n)).map((function(e){return"  - "+e})).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map((function(e){return"  - "+e})).join("\n")].join("\n"));return Object(d["c"])(b,l)}return Array.isArray(s)&&1===s.length?s[0]:s}return Object(d["o"])(u,l,s)}function v(e,t){void 0===t&&(t=[]);for(var n,r=Object.assign({},e),a=i(t);!(n=a()).done;){var c=n.value;c in r&&delete r[c]}return r}function m(e){return null!=e&&("string"===typeof e.type||("object"===typeof e.type||"function"===typeof e.type))}(function(e){e[e["None"]=0]="None",e[e["RenderStrategy"]=1]="RenderStrategy",e[e["Static"]=2]="Static"})(u||(u={})),function(e){e[e["Unmount"]=0]="Unmount",e[e["Hidden"]=1]="Hidden"}(l||(l={})),function(e){e["Space"]=" ",e["Enter"]="Enter",e["Escape"]="Escape",e["Backspace"]="Backspace",e["ArrowLeft"]="ArrowLeft",e["ArrowUp"]="ArrowUp",e["ArrowRight"]="ArrowRight",e["ArrowDown"]="ArrowDown",e["Home"]="Home",e["End"]="End",e["PageUp"]="PageUp",e["PageDown"]="PageDown",e["Tab"]="Tab"}(s||(s={}));var h=0;function j(){return++h}function O(){return j()}function g(e){var t;return null==e||null==e.value?null:null!=(t=e.value.$el)?t:e.value}function y(e,t){if(e)return e;var n=null!=t?t:"button";return"string"===typeof n&&"button"===n.toLowerCase()?"button":void 0}function w(e,t){var n=Object(d["G"])(y(e.value.type,e.value.as));return Object(d["y"])((function(){n.value=y(e.value.type,e.value.as)})),Object(d["V"])((function(){var e;n.value||g(t)&&g(t)instanceof HTMLButtonElement&&!(null==(e=g(t))?void 0:e.hasAttribute("type"))&&(n.value="button")})),n}var x=Symbol("LabelContext");function k(){var e=Object(d["p"])(x,null);if(null===e){var t=new Error("You used a <Label /> component, but it is not inside a parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,k),t}return e}Boolean;var G=Symbol("GroupContext"),S=Object(d["m"])({name:"Switch",emits:{"update:modelValue":function(e){return!0}},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:!1}},render:function(){var e={checked:this.$props.modelValue},t={id:this.id,ref:"el",role:"switch",type:this.type,tabIndex:0,"aria-checked":this.$props.modelValue,"aria-labelledby":this.labelledby,"aria-describedby":this.describedby,onClick:this.handleClick,onKeyup:this.handleKeyUp,onKeypress:this.handleKeyPress};return b({props:r({},this.$props,t),slot:e,attrs:this.$attrs,slots:this.$slots,name:"Switch"})},setup:function(e,t){var n=t.emit,r=t.attrs,a=Object(d["p"])(G,null),c="headlessui-switch-"+O();function o(){n("update:modelValue",!e.modelValue)}var i=Object(d["G"])(null),u=null===a?i:a.switchRef;return{id:c,el:u,type:w(Object(d["d"])((function(){return{as:e.as,type:r.type}})),u),labelledby:null==a?void 0:a.labelledby,describedby:null==a?void 0:a.describedby,handleClick:function(e){e.preventDefault(),o()},handleKeyUp:function(e){e.key!==s.Tab&&e.preventDefault(),e.key===s.Space&&o()},handleKeyPress:function(e){e.preventDefault()}}}})},5212:function(e,t,n){"use strict";n("d99d")},a434:function(e,t,n){"use strict";var r=n("23e7"),a=n("da84"),c=n("23cb"),o=n("5926"),i=n("07fa"),u=n("7b0b"),l=n("65f0"),s=n("8418"),d=n("1dde"),f=d("splice"),b=a.TypeError,p=Math.max,v=Math.min,m=9007199254740991,h="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,a,d,f,j,O=u(this),g=i(O),y=c(e,g),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=g-y):(n=w-2,r=v(p(o(t),0),g-y)),g+n-r>m)throw b(h);for(a=l(O,r),d=0;d<r;d++)f=y+d,f in O&&s(a,d,O[f]);if(a.length=r,n<r){for(d=y;d<g-r;d++)f=d+r,j=d+n,f in O?O[j]=O[f]:delete O[j];for(d=g;d>g-r+n;d--)delete O[d-1]}else if(n>r)for(d=g-r;d>y;d--)f=d+r-1,j=d+n-1,f in O?O[j]=O[f]:delete O[j];for(d=0;d<n;d++)O[d+y]=arguments[d+2];return O.length=g-r+n,a}})},a85c:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));n("d3b7");var r=n("7a23"),a=function(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map((function(e){e(n)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,n)}))}}},c=a(),o=Object(r["G"])(!1),i=function(){c.emit("success")},u=function(){c.emit("cancel")};function l(){return{showModal:o,handleSuccess:i,handleCancel:u}}function s(){return o.value=!0,new Promise((function(e){c.on("success",(function(){e(!0)})),c.on("cancel",(function(){e(!1)}))}))}},d99d:function(e,t,n){},ef31:function(e,t,n){"use strict";n("3483")}}]);
//# sourceMappingURL=chunk-674ac3fb.0cc34b5e.js.map