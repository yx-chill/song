{"version":3,"sources":["webpack:///./src/views/Song.vue","webpack:///./src/views/Song.vue?2da9","webpack:///./src/views/Song.vue?473b"],"names":["class","isPlay","isLike","favorite","isLogin","style","play","src","data","song","image","alt","newSong","name","composer","songId","favoriteList","songs","status","getFaoriteSong","request","res","forEach","item","id","value","console","log","router","getSongData","undefined","method","url","then","catch","error","response","push","setup","route","store","params","curr","getters","getCurrentSong","playing","storage","get","dispatch","__exports__","render"],"mappings":"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","file":"js/chunk-b3f255ae.facedb5b.js","sourcesContent":["<template>\n  <section class=\"song p-5 w-full h-full flex\">\n    <div class=\"w-full  xl:w-1/2 bg-opacity-50 relative transform duration-300\"\n      :class=\"isPlay ? 'bg-blue-400' : 'bg-yellow-400'\">\n      <button class=\"bg-gray-900 rounded-full w-12 h-12 flex justify-center items-center\n        absolute top-3 right-3\" v-show=\"isLogin\">\n        <i class=\"far fa-heart text-2xl text-red-600\"\n          :class=\"isLike ? 'fa' : 'far'\" @click=\"favorite\"></i>\n      </button>\n      <div class=\"record w-60 h-60 relative mb-10\"\n        :style=\"{ 'animation-play-state': play ? 'running' : 'paused' }\">\n        <div class=\"w-28 h-28 rounded-full overflow-hidden absolute top-1/2 left-1/2\n          transform -translate-x-1/2  -translate-y-1/2\">\n          <img :src=\"data.song.image || require('@/assets/headphone.jpg')\" alt=\"song photo\"\n            class=\"w-full h-full\">\n        </div>\n      </div>\n      <div class=\"p-10\">\n        <div class=\"flex mb-10 items-center\">\n          <button class=\"bg-gray-900 rounded-full w-20 h-20 flex justify-center items-center\"\n            @click.prevent=\"newSong(song)\">\n            <i class=\"fa fa-play ml-1 text-3xl text-gray-300\"></i>\n          </button>\n        </div>\n        <div>\n          <h2 class=\"text-4xl text-gray-800 font-black p-2 mb-10\">\n            {{ data.song.name }}</h2>\n          <span class=\"text-2xl text-gray-800 font-black p-2\">\n            {{ data.song.composer }}</span>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport {\n  computed, ref, reactive, watch, watchEffect,\n} from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute, useRouter } from 'vue-router';\nimport axios from 'axios';\nimport request from '@/includes/request';\nimport storage from '@/includes/storage';\n\n// 取得收藏列表\nconst handleFavoriteSong = (songId) => {\n  const favoriteList = { songs: [] };\n  const status = ref(false);\n  const getFaoriteSong = (async () => {\n    try {\n      const res = await request('get', 'v1/music/like');\n      favoriteList.songs = res.data.data;\n      favoriteList.songs.forEach((item) => {\n        if (item.id === +songId) {\n          status.value = true;\n        }\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  });\n  return { getFaoriteSong, status };\n};\n// 取得音樂資訊\nconst handleGetSongData = (songId) => {\n  const router = useRouter();\n  const data = reactive({ song: [] });\n  const song = { value: [] };\n  const getSongData = async () => {\n    if (songId === undefined) return;\n    await axios({\n      method: 'get',\n      url: `https://api.sally-handmade.com/music/v1/music/${songId}`,\n    }).then((res) => {\n      song.value = res.data.data;\n      data.song = res.data.data;\n    }).catch((error) => {\n      if (error.response.status === 404) {\n        router.push({ name: 'notfound' });\n      }\n    });\n  };\n\n  return { data, song, getSongData };\n};\n// 收藏&取消收藏\nconst handleFavorite = (songId, status) => {\n  const isLike = status;\n  const favorite = async () => {\n    if (!status.value) {\n      try {\n        await request('get', `v1/music/${songId}/like`);\n        isLike.value = true;\n      } catch (error) {\n        console.log(error);\n      }\n    } else {\n      try {\n        await request('get', `v1/music/${songId}/unlike`);\n        isLike.value = false;\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n  return { favorite, isLike };\n};\n\nexport default {\n  name: 'Song',\n  setup() {\n    const route = useRoute();\n    const store = useStore();\n    const songId = computed(() => route.params.songId);\n\n    const curr = computed(() => store.getters.getCurrentSong);\n    const play = computed(() => store.getters.playing);\n    const isPlay = ref(curr.value.id === +songId.value);\n    const isLogin = ref(storage.get('userToken'));\n\n    const { getFaoriteSong, status } = handleFavoriteSong(songId.value);\n    const { favorite, isLike } = handleFavorite(songId.value, status);\n    const { data, song, getSongData } = handleGetSongData(songId.value);\n\n    if (isLogin.value) getFaoriteSong();\n    getSongData();\n    const newSong = () => {\n      store.dispatch('newSong', song.value);\n    };\n\n    watch(curr, () => {\n      isPlay.value = (curr.value.id === +songId.value) || false;\n    });\n\n    watch(songId, () => {\n      getSongData();\n    });\n\n    watchEffect(() => handleFavorite(songId, status));\n\n    return {\n      songId, play, isPlay, song, data, newSong, isLike, favorite, isLogin,\n    };\n  },\n};\n</script>\n\n<style scoped>\n.song {\n  background: url('https://picsum.photos/1650/780');\n  background-size: cover;\n}\n.record {\n  background: url('../assets/record.png');\n  background-size: cover;\n  animation: slidein 10s linear infinite;\n  animation-play-state: running;\n}\n@keyframes slidein {\n  from {\n    transform: rotate(0);\n  }\n\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","import { render } from \"./Song.vue?vue&type=template&id=0a09ade6&scoped=true\"\nimport script from \"./Song.vue?vue&type=script&lang=js\"\nexport * from \"./Song.vue?vue&type=script&lang=js\"\n\nimport \"./Song.vue?vue&type=style&index=0&id=0a09ade6&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\xampp\\\\htdocs\\\\song\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0a09ade6\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Song.vue?vue&type=style&index=0&id=0a09ade6&scoped=true&lang=css\""],"sourceRoot":""}